

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ROSLink Overview &mdash; Gaitech EDU 2.5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gaitech32.jpg"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Gaitech EDU 2.5 documentation" href="../index.html"/>
        <link rel="up" title="ROSLink" href="index.html"/>
        <link rel="next" title="ROSLink Bridge for Ar Drone" href="roslink-parrot.html"/>
        <link rel="prev" title="ROSLink" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Gaitech EDU
          

          
            
            <img src="../_static/gaitechlogo150.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/get-started.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ros/ros-tutorials.html">ROS Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ROSLink</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ROSLink Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-create-roslink-bridge-client">How to Create ROSLink Bridge Client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="roslink-parrot.html">ROSLink for Parrot</a></li>
<li class="toctree-l2"><a class="reference internal" href="roslink-turtlebot.html">ROSLink for Turtlebot</a></li>
<li class="toctree-l2"><a class="reference internal" href="roslink-gapter.html">ROSLink for Gapter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../turtlebot/turtlebot-tutorials.html">Turtlebot Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../drones/index.html">Drones Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gapter/index.html">Gapter Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../video/index.html">Video Streaming Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dronemap/index.html">Dronemap Planner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributors/index.html">Contributors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Gaitech EDU</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">ROSLink</a> &raquo;</li>
      
    <li>ROSLink Overview</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/roslink/roslink-overview.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="roslink-overview">
<span id="roslink"></span><h1>ROSLink Overview<a class="headerlink" href="#roslink-overview" title="Permalink to this headline">¶</a></h1>
<p>The architecture of ROSLink is depicted in Figure 1.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../_images/roslink_fig_1.png"><img alt="../_images/roslink_fig_1.png" src="../_images/roslink_fig_1.png" style="width: 400pt;" /></a>
<p class="caption"><span class="caption-text">Figure 1: ROSLink Architecture</span></p>
</div>
<p>The ROSLink is composed of three main parts:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code>: this is the main component of the system. It is the interface between ROS and the ROSLink protocol. This bridge has two main functionalities: (1) it reads data from messages of ROS topics and services, serializes the data in JSON format according to ROSLink protocol specification, and sends to a ground station, a proxy server or a client application, (2) receives JSON serialized data through a network interface from a ground station or a client application, deserializes it from the JSON string, parse the command, and executes it through ROS.</li>
<li>The <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Proxy</span></code> and Cloud: it acts as a proxy server between the ROSLink Bridge (embedded in the robot) and the user client application. Its role is to link a user client application to a ROS-enabled robot through its ROSLink Bridge. The ROSLink proxy is mainly a forwarder of ROSLink messages between the robot and user. It allows to keep the user updated with the robot status, and also forward control commands from the user to the robot. In addition <code class="docutils literal"><span class="pre">ROSProxy</span></code> interact with ROSLink Cloud component, to maintain and manages the list of robots and users, create a mapping between them, and perform all management functionality, including security, quality-of-service monitoring, etc.</li>
<li>The <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Client</span> <span class="pre">Application</span></code>: it basically represents a control and monitoring application of the robot. This application is intended to monitor the status of the robot that it receives through ROSLink messages via the ROSLink Proxy from the robot. In addition, it sends commands through ROSLink messages to control the robot activities.</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> consists of fully-functional ROS script written in Python, which is executed as ROS node in the client. Different <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> most be created for each robot which can be either real or simulated.</p>
<div class="section" id="how-to-create-roslink-bridge-client">
<h2>How to Create ROSLink Bridge Client<a class="headerlink" href="#how-to-create-roslink-bridge-client" title="Permalink to this headline">¶</a></h2>
<p>Following steps show how to create a <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> client:</p>
<p><strong>Step 1: Identify required topics:</strong> First step before writing <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> is to know all the needed topics to be used to get information from or to publish on them. Also, the data structure for the message to be passed on the topic must be known. Thus, for each topic we have to specify following: <code class="docutils literal"><span class="pre">topic</span> <span class="pre">name</span></code>, <code class="docutils literal"><span class="pre">Message</span> <span class="pre">type</span></code>, <code class="docutils literal"><span class="pre">publish</span></code> or <code class="docutils literal"><span class="pre">subscribe</span></code>.</p>
<p><strong>Step 2: Declare a set of ROS publishers and subscribers:</strong> <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> is a fully-functional ROS node, so it can access all ROS topics and services. The publishers and subscribers cab be declared for all the required topics in the same way as in any typical ROS node.</p>
<p><strong>Step 3: Declare a set of ROS parameters:</strong> Some information about the robot or the system can be provided as parameters such as: <code class="docutils literal"><span class="pre">robot</span> <span class="pre">name</span></code>, <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">proxy</span> <span class="pre">IP</span></code>, <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">proxy</span> <span class="pre">port</span></code>, <code class="docutils literal"><span class="pre">heartbeat</span> <span class="pre">message</span> <span class="pre">period</span></code>, <code class="docutils literal"><span class="pre">system</span> <span class="pre">ID</span></code>, etc. These parameters can be assigned with some default values and also can be configured as needed from ROS launch file.</p>
<p><strong>Step 4: Declare ROSLink messages:</strong> Create data structure or class to represent <code class="docutils literal"><span class="pre">ROSLink</span></code> messages. Different <code class="docutils literal"><span class="pre">ROSLink</span></code> messages can have different structure, an array or a list or any other data structure can be used to represent them. The ROSLink communication protocol is based on the exchange of ROSLink messages. ROSLink messages are JSON formatted strings that contain information about the command and its parameters. To standardize the type of messages exchanged, we specified a set of ROSLink messages that are supported by the ROSLink Proxy. These messages can be easily extended based on the requirements of the user and the application. There are two main categories of ROSLink messages: (i.) State messages: these are message sent by the robot and carry out information about the internal state of the robot, including its position, orientation, battery level, etc. (ii.) Command messages: these are messages sent by the client application to the robot and carry out commands to make the robot execute some actions, like for example moving, executing a mission, going to a goal location, etc.</p>
<p>A ROSLink message is a composed of a header and a payload. The structure of the ROSLink message header is presented in Figure 2.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/roslink_fig_2.png"><img alt="../_images/roslink_fig_2.png" src="../_images/roslink_fig_2.png" style="width: 400pt;" /></a>
<p class="caption"><span class="caption-text">Figure 2: ROSLink Message Header Structure</span></p>
</div>
<p>The total header size is 128 bits:</p>
<p>The <code class="docutils literal"><span class="pre">roslink</span> <span class="pre">version</span></code> is encoded as a short int on 8 bits and specifies the version of ROSLink protocol.</p>
<p>The <code class="docutils literal"><span class="pre">ros</span> <span class="pre">version</span></code> specifies the ROS version (e.g. Indigo).</p>
<p>The <code class="docutils literal"><span class="pre">system</span> <span class="pre">id</span></code> is an int encoded into 16 bits and specifies the ID of the robot. It helps in differentiating robots from each other at the server side. It is possible to encode the system id in 8 bits to reduce the header size, but the problem this restricts the scalability of the system to only 256 robots ID.</p>
<p>The <code class="docutils literal"><span class="pre">message</span> <span class="pre">id</span></code> specifies the type of message received. It helps in correctly parsing the incoming message and extract underlying information.</p>
<p>The <code class="docutils literal"><span class="pre">sequence</span> <span class="pre">number</span></code> denotes the sequence of the packet, identifies a single packet, and avoid processing duplicate packets.</p>
<p>The <code class="docutils literal"><span class="pre">key</span></code> field is encoded on 24 bits and is used to identify a robot, and to map it to a user. A user that would like to have access to a robot, must use the same key that the robot is using in its Heartbeat message.</p>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">ROSLinkHeader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

       <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roslink_version</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ros_version</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">system_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">message_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sequence_number</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">roslink_version</span> <span class="o">=</span> <span class="n">roslink_version</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">ros_version</span> <span class="o">=</span> <span class="n">ros_version</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">system_id</span> <span class="o">=</span> <span class="n">system_id</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">message_id</span> <span class="o">=</span> <span class="n">message_id</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">sequence_number</span> <span class="o">=</span> <span class="n">sequence_number</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
               <span class="k">pass</span>

       <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">roslink_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;roslink_version&#39;</span><span class="p">]</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">ros_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;ros_version&#39;</span><span class="p">]</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">system_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;system_id&#39;</span><span class="p">]</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">message_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;message_id&#39;</span><span class="p">]</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">sequence_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;sequence_number&#39;</span><span class="p">]</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">][</span><span class="s1">&#39;key&#39;</span><span class="p">]</span>

       <span class="k">def</span> <span class="nf">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
               <span class="k">print</span> <span class="s1">&#39;--------------------------&#39;</span>
               <span class="k">print</span> <span class="s1">&#39;roslink_version: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">roslink_version</span>
               <span class="k">print</span> <span class="s1">&#39;ros_version    : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ros_version</span>
               <span class="k">print</span> <span class="s1">&#39;system_id      : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_id</span>
               <span class="k">print</span> <span class="s1">&#39;message_id     : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_id</span>
               <span class="k">print</span> <span class="s1">&#39;sequence_number: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence_number</span>
               <span class="k">print</span> <span class="s1">&#39;key            : &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span>
               <span class="k">print</span> <span class="s1">&#39;--------------------------&#39;</span>
</pre></div>
</div>
<p>The payload carries out data relevant for each ROSLink message type. ROSLink defines several state message and command types. Following is the most common state and command messages:</p>
<p><strong>Presence message:</strong> the robot should declare its presence regularly to declare itself and to be considered as active. Typically, Heartbeat messages sent at a certain frequency (typically one message per second) are used for this purpose. Following is the heartbeat message class:</p>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">HeartBeat</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">robot_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">system_status</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">owner_id</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">robot_type</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">system_status</span> <span class="o">=</span> <span class="n">system_status</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">owner_id</span> <span class="o">=</span> <span class="n">owner_id</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>

   <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


   <span class="k">def</span> <span class="nf">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">print</span> <span class="s1">&#39;type: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>
       <span class="k">print</span> <span class="s1">&#39;name: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
       <span class="k">print</span> <span class="s1">&#39;system_status: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_status</span>
       <span class="k">print</span> <span class="s1">&#39;owner_id: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner_id</span>
       <span class="k">print</span> <span class="s1">&#39;mode: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span>
</pre></div>
</div>
<p><strong>Motion messages:</strong> In robot mission, it is important to know the location and odometry motion parameters (i.e.linear and angular velocities) of the robot at a certain time. Thus, a motion message containing position information of the robot should be periodically broadcast.</p>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">GlobalMotion</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time_boot_ms</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vy</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vz</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  <span class="n">wx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wy</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">wz</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pitch</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">roll</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">time_boot_ms</span> <span class="o">=</span> <span class="n">time_boot_ms</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="n">vx</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="n">vy</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">vz</span> <span class="o">=</span> <span class="n">vz</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">wx</span> <span class="o">=</span> <span class="n">wx</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">wy</span> <span class="o">=</span> <span class="n">wy</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">wz</span> <span class="o">=</span> <span class="n">wz</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="n">pitch</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="n">roll</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="n">heading</span>

   <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">print</span> <span class="s1">&#39;time_boot_ms: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_boot_ms</span>
       <span class="k">print</span> <span class="s1">&#39;x: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
       <span class="k">print</span> <span class="s1">&#39;y: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
       <span class="k">print</span> <span class="s1">&#39;z: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
       <span class="k">print</span> <span class="s1">&#39;vx: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vx</span>
       <span class="k">print</span> <span class="s1">&#39;vy: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy</span>
       <span class="k">print</span> <span class="s1">&#39;vz: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vz</span>
       <span class="k">print</span> <span class="s1">&#39;wx: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wx</span>
       <span class="k">print</span> <span class="s1">&#39;wy: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wy</span>
       <span class="k">print</span> <span class="s1">&#39;wz: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wz</span>
       <span class="k">print</span> <span class="s1">&#39;pitch: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pitch</span>
       <span class="k">print</span> <span class="s1">&#39;roll: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">roll</span>
       <span class="k">print</span> <span class="s1">&#39;heading: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">heading</span>
</pre></div>
</div>
<p><strong>Sensor messages:</strong> The robot needs to broadcast its internal sensor data such as IMU, laser scanners, camera images, GPS coordinates, actuators states, etc. ROSLink also defines several sensor messages to exchange these data between the robot and the user.</p>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">GPSRawInfo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time_usec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fix_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">eph</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">epv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cog</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">satellites_visible</span> <span class="o">=</span> <span class="bp">None</span> <span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">time_usec</span> <span class="o">=</span> <span class="n">time_usec</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">fix_type</span> <span class="o">=</span> <span class="n">fix_type</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">lat</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="n">lon</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">alt</span> <span class="o">=</span> <span class="n">alt</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">eph</span> <span class="o">=</span> <span class="n">eph</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">epv</span> <span class="o">=</span> <span class="n">epv</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">vel</span> <span class="o">=</span> <span class="n">vel</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">cog</span> <span class="o">=</span> <span class="n">cog</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">satellites_visible</span> <span class="o">=</span> <span class="n">satellites_visible</span>

   <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">print</span> <span class="s1">&#39;time_usec: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_usec</span>
       <span class="k">print</span> <span class="s1">&#39;fix_type: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fix_type</span>
       <span class="k">print</span> <span class="s1">&#39;lat: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span>
       <span class="k">print</span> <span class="s1">&#39;lon: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon</span>
       <span class="k">print</span> <span class="s1">&#39;alt: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">alt</span>
       <span class="k">print</span> <span class="s1">&#39;eph: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eph</span>
       <span class="k">print</span> <span class="s1">&#39;epv: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epv</span>
       <span class="k">print</span> <span class="s1">&#39;vel: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vel</span>
       <span class="k">print</span> <span class="s1">&#39;cog: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cog</span>
       <span class="k">print</span> <span class="s1">&#39;satellites_visible: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">satellites_visible</span>
</pre></div>
</div>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">RangeFinderData</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time_usec</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">angle_min</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">angle_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">angle_increment</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">time_increment</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scan_time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">range_min</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">range_max</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">intensities</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">time_usec</span> <span class="o">=</span> <span class="n">time_usec</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">angle_min</span> <span class="o">=</span> <span class="n">angle_min</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">angle_max</span> <span class="o">=</span> <span class="n">angle_max</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">angle_increment</span> <span class="o">=</span> <span class="n">angle_increment</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">time_increment</span> <span class="o">=</span> <span class="n">time_increment</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">scan_time</span> <span class="o">=</span> <span class="n">scan_time</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">range_min</span> <span class="o">=</span> <span class="n">range_min</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">range_max</span> <span class="o">=</span> <span class="n">range_max</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span> <span class="o">=</span> <span class="n">ranges</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">intensities</span> <span class="o">=</span> <span class="n">intensities</span>

   <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="k">print</span> <span class="s1">&#39;time_usec: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_usec</span>
       <span class="k">print</span> <span class="s1">&#39;angle_min: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_min</span>
       <span class="k">print</span> <span class="s1">&#39;angle_max: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_max</span>
       <span class="k">print</span> <span class="s1">&#39;angle_increment: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_increment</span>
       <span class="k">print</span> <span class="s1">&#39;time_increment: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_increment</span>
       <span class="k">print</span> <span class="s1">&#39;scan_time: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_time</span>
       <span class="k">print</span> <span class="s1">&#39;range_min: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range_min</span>
       <span class="k">print</span> <span class="s1">&#39;range_max: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range_max</span>
       <span class="k">print</span> <span class="s1">&#39;ranges: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges</span>
       <span class="k">print</span> <span class="s1">&#39;intensities: &#39;</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensities</span>
</pre></div>
</div>
<p><strong>Motion commands:</strong> For the robot to navigate in ROS, certain commands are sent to it like <code class="docutils literal"><span class="pre">Twist</span></code> messages in ROS, goal/waypoint locations, and takeoff/landing command for drones.</p>
<p>The takeoff command message class:</p>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">Takeoff</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">altitude</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
       <span class="bp">self</span><span class="o">.</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">altitude</span>
</pre></div>
</div>
<p>The landing command message class:</p>
<div class="highlight-Python"><div class="highlight"><pre><span></span><span class="n">__package__</span> <span class="o">=</span> <span class="s1">&#39;messages&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">Land</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
</pre></div>
</div>
<p>The aforementioned list is not exhaustive as other types of messages can be designed based on the requirements of the users and available information from the robot.</p>
<p><strong>Step 5: Send ROSLink message:</strong> After subscribing to topics and getting their information, the <code class="docutils literal"><span class="pre">ROSLink</span></code> messages will be updated with these information and sent to the <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">proxy</span></code>.</p>
<p><strong>Step 6: Receive ROSLink message:</strong> The <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> will receive command messages from <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">proxy</span></code>. After parsing the incoming <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Message</span></code> and extracting the command, the <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> publishes the command to the appropriate ROS topic or request the appropriate ROS service to execute the action. The <code class="docutils literal"><span class="pre">ROSLink</span> <span class="pre">Bridge</span></code> will know what topic to publish with message content from <code class="docutils literal"><span class="pre">message_id</span></code> field from  <code class="docutils literal"><span class="pre">ROSLink</span></code> message.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="roslink-parrot.html" class="btn btn-neutral float-right" title="ROSLink Bridge for Ar Drone" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="ROSLink" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Gaitech.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54522619-2', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>