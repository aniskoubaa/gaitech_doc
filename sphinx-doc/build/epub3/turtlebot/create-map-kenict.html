<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Building a Map with a Turtlebot</title>
    
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="send-goals-nav-stack.html" title="Sending Goals to the Navigation Stack"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="navigation-stack.html" title="Navigation Stack"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Gaitech EDU 2.5 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="turtlebot-tutorials.html" accesskey="U">Turtlebot Quick Start Tutorials</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="building-a-map-with-a-turtlebot">
<span id="create-map-kenict"></span><h1>Building a Map with a Turtlebot</h1>
<p>In this tutorial, you will learn how to build your own map using 3D sensor attached to your Turtlebot.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>In this tutorial, you will:</p>
<blockquote class="last">
<div><ul class="simple">
<li>Learn how to build a map with a Turtlebot</li>
<li>Understand the stucture of a map in navigation stack of ROS</li>
</ul>
</div></blockquote>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure that you already made the tutorial on <a class="reference internal" href="openKinect-turtlebot.html#openkinect-turtlebot"><span class="std std-ref">Setting-up 3D Sensor for the Turtlebot</span></a>.</p>
</div>
<p>As mentioned in <a class="reference internal" href="openKinect-turtlebot.html#openkinect-turtlebot"><span class="std std-ref">Setting-up 3D Sensor for the Turtlebot</span></a>, ROS indigo supports by default <code class="docutils literal"><span class="pre">Asus</span> <span class="pre">Live</span> <span class="pre">Pro</span></code> 3D sensor and has no default support to <code class="docutils literal"><span class="pre">Kinect</span></code> 3D sensor.
First, you need to check which 3D sensor you Turtlebot is having, and make appropriate configuration. For more details about the configuration of the 3D sensor on Turtlebot, refer to <a class="reference internal" href="openKinect-turtlebot.html#openkinect-turtlebot"><span class="std std-ref">Setting-up 3D Sensor for the Turtlebot</span></a>.</p>
<div class="section" id="running-the-map-building-experiments">
<h2>Running the Map Building Experiments</h2>
<p>First, you need to start the robot drivers and then start the ROS node responsible for building the map.
It has to be noted that to build a map ROS uses the <code class="docutils literal"><span class="pre">gmapping</span></code> software package, that is fully integrated with ROS.
Thew gmapping package contains a ROS wrapper for OpenSlam&#8217;s Gmapping.
The  package provides laser-based SLAM (Simultaneous Localization and Mapping), as a ROS node called <code class="docutils literal"><span class="pre">slam_gmapping</span></code>. Using <code class="docutils literal"><span class="pre">slam_gmapping</span></code>, you can create a 2-D occupancy grid map (like a building floorplan) from laser and pose data collected by a mobile robot.</p>
<p>To start the robot, on the master node (the robot machine) run the following commands, on three terminals:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>roscore
roslaunch turtlebot_bringup minimal.launch
roslaunch turtlebot_navigation gmapping_demo.launch
</pre></div>
</div>
<p>To drive the robot from your workstation, then, on your workstation (the host node), run the following commands:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>roslaunch turtlebot_rviz_launchers view_navigation.launch
roslaunch turtlebot_teleop keyboard_teleop.launch
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you execute the following command on your workstation (recommended), you must make sure to have correctly set-up the network configuration as explained in <a class="reference internal" href="network-config-doc.html#network-config-doc"><span class="std std-ref">Network Configuration</span></a>.
It is not recommended to <code class="docutils literal"><span class="pre">view_navigation</span></code> launch file on the robot machine as rviz may overload the robot.</p>
</div>
<p>If all is correct, start moving the robot around using <code class="docutils literal"><span class="pre">keyboard</span> <span class="pre">teleop</span></code> application or a joytsick and watch the <code class="docutils literal"><span class="pre">RViz</span></code> GUI as the map starts to be built-up.</p>
<p>Finally you will end-up with a map looking like this one:</p>
<img alt="../_images/kenict_map.png" class="align-center" src="../_images/kenict_map.png" />
<p>You can save the map you just created by running the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>rosrun map_server map_saver -f /tmp/my_map
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">tmp</span></code> file gets cleaned everytime the system is booted so after saving the map you can move the files to another location or save it in another location directly.</p>
</div>
<p>The previous command will generate two file in the name you specify so in this case the two file&#8217;s names are <code class="docutils literal"><span class="pre">my_map.pgm</span></code> and <code class="docutils literal"><span class="pre">my_map.yaml</span></code>.
If you opened the <code class="docutils literal"><span class="pre">.yaml</span></code> file you will see something like this:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/my_map.pgm</span>
<span class="l l-Scalar l-Scalar-Plain">resolution</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0.050000</span>
<span class="l l-Scalar l-Scalar-Plain">origin</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">-12.200000</span><span class="p p-Indicator">,</span> <span class="nv">-12.200000</span><span class="p p-Indicator">,</span> <span class="nv">0.000000</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">negate</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="l l-Scalar l-Scalar-Plain">occupied_thresh</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0.65</span>
<span class="l l-Scalar l-Scalar-Plain">free_thresh</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">0.196</span>
</pre></div>
</div>
<p>Everyline specify a certain information from the map&#8217;s file which is the <code class="docutils literal"><span class="pre">.pgm</span></code> file, the resolution of the map, the starting location of the turtlebot robot to how much space does the obstacles/free space occupy from the map.</p>
<p>The <code class="docutils literal"><span class="pre">.pgm</span></code> is just an image of the map which you can open using any image editor program and it will look like this:</p>
<img alt="../_images/pgm_map.png" class="align-center" src="../_images/pgm_map.png" />
</div>
<div class="section" id="video-demonstration">
<h2>Video Demonstration</h2>
<iframe width="640" height="360" src="http://www.youtube.com/embed/QzZif1e767k" frameborder="0" allowfullscreen="1">&nbsp;</iframe></div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Gaitech.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54522619-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>