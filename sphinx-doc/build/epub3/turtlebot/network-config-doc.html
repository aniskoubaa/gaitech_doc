<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Network Configuration</title>
    
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="turtlebot-simulators.html" title="Turtlebot Simulators"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="openKinect-turtlebot.html" title="Setting-up 3D Sensor for the Turtlebot"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Gaitech EDU 2.5 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="turtlebot-tutorials.html" accesskey="U">Turtlebot Quick Start Tutorials</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="network-configuration">
<span id="network-config-doc"></span><h1>Network Configuration</h1>
<p>This tutorial will introduce to you to configure your turtlebot robot to communicate with your computer machine, so that you can execute program, which you develop and run on your machine, remotely on the Turtlebot.
We refer to your personal machine as <strong>workstation</strong> and the robot laptop as <strong>robot machine</strong>.
The objective of this configuration is to make the robot machine and your workstation use the same <code class="docutils literal"><span class="pre">ROS</span> <span class="pre">Mater</span> <span class="pre">node</span></code> so that any ROS topic or ROS service on the robot will also be available on the workstation.
As such, any ROS program or script that runs on your machine, will have direct access to the ROS topics and ROS services, and thus, it can control and monitor the robot remotely from the workstation.
To allow this, it is needed to configure the laptop of your robot and your machine to be able to communicate.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure that you completed installing all the required packets in the previous tutorials.</p>
</div>
<div class="section" id="video-tutorial">
<h2>Video Tutorial</h2>
<p>The following video tutorial illustrates in 10 minutes the steps to follow for network configuration in ROS and demonstrates it through an example.</p>
<iframe width="640" height="360" src="http://www.youtube.com/embed/1KOrXSEDQ3k" frameborder="0" allowfullscreen="1">&nbsp;</iframe></div>
<div class="section" id="getting-your-ip-address">
<h2>Getting your IP address</h2>
<p>ROS offers the ability to have a two-way communication network between different ROS nodes. All what you have to do is to know the IP address for the ROS master node and the IPs for other ROS nodes.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For Ubuntu users: to know the IP address for your device in the network you are connected to, you can open a terminal and type <code class="docutils literal"><span class="pre">ifconfig</span></code> and you will find something similar to the following:</p>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>lo     Link encap:Local Loopback
       inet addr:127.0.0.1  Mask:255.0.0.0
       inet6 addr: ::1/128 Scope:Host
       UP LOOPBACK RUNNING  MTU:16436  Metric:1
       RX packets:6658055 errors:0 dropped:0 overruns:0 frame:0
       TX packets:6658055 errors:0 dropped:0 overruns:0 carrier:0
       collisions:0 txqueuelen:0
       RX bytes:587372914 <span class="o">(</span>587.3 MB<span class="o">)</span>  TX bytes:587372914 <span class="o">(</span>587.3 MB<span class="o">)</span>

wlan1  Link encap:Ethernet  HWaddr 48:5d:60:75:58:90
       inet addr:10.0.129.17  Bcast:10.0.129.255  Mask:255.255.254.0
       inet6 addr: fe80::4a5d:60ff:fe75:5890/64 Scope:Link
       UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
       RX packets:101983 errors:0 dropped:0 overruns:0 frame:0
       TX packets:37244 errors:0 dropped:0 overruns:0 carrier:0
       collisions:0 txqueuelen:1000
       RX bytes:49326141 <span class="o">(</span>49.3 MB<span class="o">)</span>  TX bytes:7588044 <span class="o">(</span>7.5 MB<span class="o">)</span>
</pre></div>
</div>
<p>In the example above, the IP address of the machine is <code class="docutils literal"><span class="pre">10.0.129.17</span></code> with respect to the WiFi network interface <code class="docutils literal"><span class="pre">wlan1</span></code>. It may happen to have a different WiFi interface like <code class="docutils literal"><span class="pre">wlan0</span></code> or others depending on network configuration of your local machine.</p>
<p>By applying the above instructions, find the IP address of your workstation, which we denote as <code class="docutils literal"><span class="pre">WORKSTATION_IP</span></code> and the IP address of your robot machine, which we denote as <code class="docutils literal"><span class="pre">TURTLEBOT_IP</span></code>.</p>
</div>
<div class="section" id="test-your-connection">
<h2>Test your connection</h2>
<p>First, make sure that ssh server is already installed on your robot machine. To do so (if not installed), on your robot machine write the following:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo apt-get install openssh-server
</pre></div>
</div>
<p>This will install openssh server if it is not installed.</p>
<p>On your workstation PC, try to connect to the Turtlebot by typing the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ssh name_of_turtlebot_PC@TURTLEBOT_IP
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">TURTLEBOT_IP</span></code> is the IP address of the turtlebot robot machine that you found in the previous step.
You will be prompted and requested the password of the robot machine, which you need to type correctly. Once done, you should now be connected to the Turtlebot and any command you will write on the terminal will be physically executed on the robot machine.
If this was successful, you can head to the next steps.</p>
</div>
<div class="section" id="configure-the-robot-and-the-workstation-to-use-the-same-ros-master">
<h2>Configure the robot and the workstation to use the same ROS Master</h2>
<p>Now, we will configure the robot machine and the workstation to use the same ROS master node, so that any program on the workstation can use the ROS topics and ROS services available on the turtlebot robot.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember that the ROS Master node is started with <code class="docutils literal"><span class="pre">roscore</span></code> command and is the main node in ROS environment that  provides naming and registration services to the rest of the nodes in the ROS system. It tracks publishers and subscribers to topics as well as services. The role of the Master is to enable individual ROS nodes to locate one another. Once these nodes have located each other they communicate with each other peer-to-peer.
More information can be found on <a class="reference external" href="http://wiki.ros.org/Master">ROS Master node</a><span class="link-target"> [http://wiki.ros.org/Master]</span></p>
</div>
<p>To be able to use ROS in any project/environment you must have a ROS master node which is the main node that a user can communicate with either in the same device or by another devices.
All you have to do is to specify in the <code class="docutils literal"><span class="pre">.bashrc</span></code> file the IP address for the Master node and the host node (the other device).</p>
<p>Open the <code class="docutils literal"><span class="pre">.bashrc</span></code> file in the robot machine (use the command <code class="docutils literal"><span class="pre">gedit</span> <span class="pre">.bashrc</span></code>). Scroll to the bottom of the file and add these lines:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1">#The localhost IP address = IP address for the Master node</span>
<span class="nb">export</span> <span class="nv">ROS_MASTER_URI</span><span class="o">=</span>http://localhost:11311
<span class="c1">#The IP address for the Master node</span>
<span class="nb">export</span> <span class="nv">ROS_HOSTNAME</span><span class="o">=</span>192.168.8.100
</pre></div>
</div>
<p>replace <code class="docutils literal"><span class="pre">192.168.8.101</span></code>  with the correct IP address of the robot machine (see above for getting the IP address).
The line <code class="docutils literal"><span class="pre">export</span> <span class="pre">ROS_MASTER_URI=http://localhost:11311</span></code> means that the ROS master runs in the localhost of the robot machine.
The line <code class="docutils literal"><span class="pre">export</span> <span class="pre">ROS_HOSTNAME=192.168.8.100</span></code> specifies the hostname of the robot machine, which must be exactly the same found with the <code class="docutils literal"><span class="pre">ifconfig</span></code> command</p>
<p>Now, in your workstation PC open the <code class="docutils literal"><span class="pre">.bashrc</span></code> file and scroll to the bottom of the file and add these lines:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">source</span> /opt/ros/indigo/setup.bash
<span class="c1">#The IP address for the Master node</span>
<span class="nb">export</span> <span class="nv">ROS_MASTER_URI</span><span class="o">=</span>http://192.168.8.100:11311
<span class="c1">#The IP address for your device/host IP address</span>
<span class="nb">export</span> <span class="nv">ROS_HOSTNAME</span><span class="o">=</span>192.168.8.101
</pre></div>
</div>
<p>The line <code class="docutils literal"><span class="pre">export</span> <span class="pre">ROS_MASTER_URI=http://192.168.8.100:11311</span></code> means that the ROS master runs in the machine with IP address <code class="docutils literal"><span class="pre">192.168.8.100</span></code> which must correspond to the robot machine IP address.
The line <code class="docutils literal"><span class="pre">export</span> <span class="pre">ROS_HOSTNAME=192.168.8.101</span></code> specifies the hostname of the workstation machine, which must be exactly the same found with the <code class="docutils literal"><span class="pre">ifconfig</span></code> command</p>
<p>Make sure to close the terminal and open a new one so that changes take effect. You can also type <code class="docutils literal"><span class="pre">source</span> <span class="pre">.bashrc</span></code>.</p>
</div>
<div class="section" id="testing-the-configuration">
<h2>Testing the configuration</h2>
<p>To test that the configuration works fine, run the following command in your robot machine that will contain the Master node (the one connected to the turtlebot):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>roscore
</pre></div>
</div>
<p>In your workstation machine, write the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>rostopic list
</pre></div>
</div>
<p>If all is fine, you should be able to see the list of topics available in the robot machine, which -in case of roscore running alone- should be:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>/rosout
/rosout_agg
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the connection is successful you will be able to see a list of all the ROS topics published from the Master node if it fails then make sure that the <code class="docutils literal"><span class="pre">ROS_MASTER_URI</span></code> is set to the right value.</p>
</div>
<p>To check whether the Master node can receive data from the host node, run this command in a workstation PC terminal:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>rostopic pub -r10 /hello std_msgs/String <span class="s2">&quot;hello&quot;</span>
</pre></div>
</div>
<p>on the robot machine that is already running the Maser node, run the following command in a new terminal:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>rostopic <span class="nb">echo</span> /hello
</pre></div>
</div>
<p>The message &#8220;hello&#8221; should appear about 10 times per second.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If something is wrong with executing the previous step, make sure that the <code class="docutils literal"><span class="pre">ROS_HOSTNAME</span></code> in the host node is correct.</p>
</div>
<p>You can also watch the example of running the turtlesim in the video tutorial above.</p>
</div>
<div class="section" id="sychronization-utilities">
<h2>Sychronization Utilities</h2>
<p>In case you faced any strange behaviour from the robot during transmitting data from a Host node to the Master node, you can download:</p>
<p>Chrony:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo apt-get install chrony
</pre></div>
</div>
<p>or</p>
<p>manually sync NTP:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo ntpdate ntp.ubuntu.com
</pre></div>
</div>
<p>to fix the clock synchronization problem.</p>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Gaitech.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54522619-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>